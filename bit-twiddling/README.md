Bit-shifting magic in C.
